"use strict";const _0x246b72=_0x2eb0;function _0x5a07(){const e=["msgtemplat","1931040EgFvru","removeRoom","essage-sys","../utils/i","length","nce","../utils/r","LeaveDebou","Search","8886100UYjGmu","ithRegexLi","all","1523822eFAfcZ","gePayload","1388403JXRmnv","plateMessa","map","parseSysms","inviteeIdL","rId","ageType","unner.js","erty","etkLz","content","default","46356PCmhZF","18iYGJYv","WechatMess","executeRun","sysmsg.js","currentUse","ist","isRoomId","JoUfd","split","roomMember","oNZGs","../types.j","gSysmsgTem","payload","userName","395848nJtfFi","1876686qompYG","Runner","7rujyJm","filter","1kMHHXa","om-leave.j","sgTemplate","parseTextW","defineProp","type","Sys","createSysm","createtime","ners"];return(_0x5a07=function(){return e})()}function _0x2eb0(e,t){const s=_0x5a07();return(_0x2eb0=function(e,t){return e-=424,s[e]})(e,t)}!function(){for(var e=_0x2eb0,t=_0x5a07();;)try{if(401358==-parseInt(e(432))*(-parseInt(e(455))/2)+-parseInt(e(457))/3+parseInt(e(469))/4+-parseInt(e(443))/5+parseInt(e(428))/6*(-parseInt(e(430))/7)+parseInt(e(427))/8*(-parseInt(e(470))/9)+parseInt(e(452))/10)break;t.push(t.shift())}catch(e){t.push(t.shift())}}(),Object[_0x246b72(436)+_0x246b72(465)](exports,"__esModule",{value:!0});const is_type_js_1=require(_0x246b72(446)+"s-type.js"),event_room_leave_js_1=require("./event-ro"+_0x246b72(433)+"s"),message_sysmsg_js_1=require("../messages/message-"+_0x246b72(473)),types_js_1=require(_0x246b72(481)+"s"),regex_js_1=require(_0x246b72(449)+"egex.js"),message_sysmsgtemplate_js_1=require("../messages/sysmsg/m"+_0x246b72(445)+_0x246b72(442)+"e.js"),runner_js_1=require(_0x246b72(449)+_0x246b72(464)),YOU_INVITE_OTHER_REGEX_LIST=[/^你邀请"(.+)"加入了群聊 {2}\$revoke\$/,/^You invited (.+) to the group chat/],OTHER_INVITE_YOU_REGEX_LIST=[/^"([^"]+?)"邀请你加入了群聊，群聊参与人还有：(.+)/,/^(.+) invited you to a group chat with (.+)/],OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST=[/^"([^"]+?)"邀请你和"(.+?)"加入了群聊/,/^(.+?) invited you and (.+?) to (the|a) group chat/],OTHER_INVITE_OTHER_REGEX_LIST=[/^"(.+)"邀请"(.+)"加入了群聊/,/^(.+?) invited (.+?) to (the|a) group chat/],OTHER_JOIN_VIA_YOUR_QRCODE_REGEX_LIST=[/^" ?(.+)"通过扫描你分享的二维码加入群聊/,/^" ?(.+)" joined group chat via the QR code you shared/],OTHER_JOIN_VIA_OTHER_QRCODE_REGEX_LIST=[/^" (.+)"通过扫描"(.+)"分享的二维码加入群聊/,/^"(.+)" joined the group chat via the QR Code shared by "(.+)"/],OTHER_JOIN_BY_GAME=[/^(.*?)通过(.+)加入群聊/,/^(.*?) joined the group chat through (.+)/];exports[_0x246b72(468)]=async(I,o)=>{const E=_0x246b72,m={etkLz:function(e,t){return e<t},oNZGs:function(e,t){return e!==t}},u=o.fromusername;if(!(0,is_type_js_1[E(476)])(u))return null;const i=o[E(440)],e=await(0,message_sysmsg_js_1[E(460)+E(424)+E(458)+E(456)])(o);if(!e&&m[E(480)](o.type,1e4))return null;let s=null;if(e){var t=(0,message_sysmsgtemplate_js_1[E(439)+E(434)+E(429)])(e,[...YOU_INVITE_OTHER_REGEX_LIST,...OTHER_JOIN_VIA_YOUR_QRCODE_REGEX_LIST],async e=>{const t=E,s=e[0].payload,_=s.map(e=>e[t(426)])[t(431)](e=>!!e);return{inviteeIdList:_,inviterId:I[t(474)+"rId"],roomId:u,timestamp:i}}),_=(0,message_sysmsgtemplate_js_1[E(439)+E(434)+E(429)])(e,OTHER_INVITE_YOU_REGEX_LIST,async e=>{var t=E,e=e[0][t(425)];return{inviteeIdList:[I["currentUse"+t(462)]],inviterId:e[0][t(426)],roomId:u,timestamp:i}}),r=(0,message_sysmsgtemplate_js_1[E(439)+E(434)+E(429)])(e,[...OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST,...OTHER_INVITE_OTHER_REGEX_LIST],async(e,t)=>{const s=E,_=e[0][s(425)],r=e[1].payload,a=r.map(e=>e[s(426)])[s(431)](e=>!!e),n=m[s(466)](t,OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST[s(447)]);return n&&a.unshift(I["currentUse"+s(462)]),{inviteeIdList:a,inviterId:_[0].userName,roomId:u,timestamp:i}}),a=(0,message_sysmsgtemplate_js_1[E(439)+E(434)+E(429)])(e,OTHER_JOIN_VIA_OTHER_QRCODE_REGEX_LIST,async e=>{var t=E;return{inviteeIdList:e[0].payload[t(459)](e=>e.userName)[t(431)](e=>!!e),inviterId:e[1].payload[0][t(426)],roomId:u,timestamp:i}}),n=(0,message_sysmsgtemplate_js_1[E(439)+E(434)+E(429)])(e,OTHER_JOIN_BY_GAME,async e=>{const t=E,s=e[0].payload,_=s.map(e=>e[t(426)])[t(431)](e=>!!e);return{inviteeIdList:_,inviterId:I[t(474)+t(462)],roomId:u,timestamp:i}});(s=await(0,runner_js_1[E(472)+"ners"])([t,_,r,a,n]))&&s[E(461)+E(475)].forEach(e=>{var t=E;(0,event_room_leave_js_1[t(444)+t(450)+t(448)])(s.roomId,e)})}else{if(m[E(480)](o[E(437)],types_js_1[E(471)+E(463)][E(438)]))return null;s=await(0,runner_js_1[E(472)+E(441)])([async()=>{const _=E;return(0,regex_js_1[_(435)+_(453)+"st"])(o[_(467)],[...YOU_INVITE_OTHER_REGEX_LIST,...OTHER_JOIN_VIA_YOUR_QRCODE_REGEX_LIST],async(e,t)=>{var s=_,t=(t[1],t[2]);return{inviteeIdList:[(await I["roomMember"+s(451)](u,t))[0]],inviterId:I[s(474)+s(462)],roomId:u,timestamp:o.createtime}})},async()=>{const _=E;return(0,regex_js_1[_(435)+_(453)+"st"])(o[_(467)],OTHER_INVITE_YOU_REGEX_LIST,async(e,t)=>{var s=_,t=t[1],t=(await I[s(479)+s(451)](u,t))[0];return{inviteeIdList:[I["currentUse"+s(462)]],inviterId:t,roomId:u,timestamp:o[s(440)]}})},async()=>{const n=E,i={JoUfd:function(e,t){return m.etkLz(e,t)}};return(0,regex_js_1[n(435)+n(453)+"st"])(o[n(467)],[...OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST,...OTHER_INVITE_OTHER_REGEX_LIST],async(e,t)=>{const s=n,_=t[1],r=await Promise[s(454)](t[2][s(478)]("、")[s(459)](async e=>{var t=s;return(await I[t(479)+t(451)](u,e))[0]})),a=i[s(477)](e,OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST.length);a&&r.unshift(I[s(474)+s(462)]);t=(await I[s(479)+s(451)](u,_))[0];return{inviteeIdList:r,inviterId:t,roomId:u,timestamp:o[s(440)]}})},async()=>{const r=E;return(0,regex_js_1[r(435)+r(453)+"st"])(o[r(467)],OTHER_JOIN_VIA_OTHER_QRCODE_REGEX_LIST,async(e,t)=>{var s=r,_=t[1],t=t[2],_=(await I["roomMember"+s(451)](u,_))[0];return{inviteeIdList:[(await I[s(479)+s(451)](u,t))[0]],inviterId:_,roomId:u,timestamp:o.createtime}})}])}return s};