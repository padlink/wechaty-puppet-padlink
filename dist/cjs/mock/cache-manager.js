"use strict";const _0x4d0dfc=_0x2db7;!function(){for(var t=_0x2db7,a=_0x2e30();;)try{if(244569==-parseInt(t(321))*(-parseInt(t(323))/2)+parseInt(t(282))/3*(-parseInt(t(225))/4)+parseInt(t(258))/5*(parseInt(t(252))/6)+-parseInt(t(228))/7+-parseInt(t(320))/8+parseInt(t(349))/9*(parseInt(t(289))/10)+parseInt(t(338))/11*(parseInt(t(226))/12))break;a.push(a.shift())}catch(t){a.push(a.shift())}}();var __importDefault=this&&this[_0x4d0dfc(229)+_0x4d0dfc(311)]||function(t){return t&&t.__esModule?t:{default:t}};Object[_0x4d0dfc(249)+_0x4d0dfc(343)](exports,_0x4d0dfc(295),{value:!0}),exports[_0x4d0dfc(333)+"er"]=void 0;const fs_extra_1=__importDefault(require(_0x4d0dfc(274))),os_1=__importDefault(require("os")),path_1=__importDefault(require(_0x4d0dfc(340))),lru_cache_1=require(_0x4d0dfc(324)),wechaty_puppet_1=require("wechaty-pu"+_0x4d0dfc(256)),flash_store_1=require(_0x4d0dfc(346)+"e"),PRE=_0x4d0dfc(331)+_0x4d0dfc(281);function _0x2e30(){const t=["room-raw-p","join","itation","rAlias","getAllCont","w-payload","12jUHfFT","12uCgWyq","rangerAlia","2688875wCoknu","__importDe","getRoom","ationCache","_friendshi","act","Member","osing cach","getRoomInv","rCache","get","push","close","friendship","CaWkh","StrangerAl","payload","setRoomMem","Search","contact-st","deleteCont","defineProp","_messageRe","che closed","72NLNwcw","hasMessage","Invitation","archCache","ppet","default","38770HLKtRZ","_labelList","_roomCache","r() lruOpt","_roomMembe","-raw-paylo","uazUC","_messageCa","close() cl",") inited ","constructo","hipRawPayl","rjTIs","deleteRoom","pathExists","che","fs-extra","_contactSt","homedir","ayload","_contactCa","plus-cache","FlashStore","ger]","332070PXFhQC","getRoomIds","es ...","_userName","already in","zDbfP","setContact","3924670DZvrap","Cwlub","ions.dispo","itialized","keys","_roomInvit","__esModule","_contactSe","hSOgt","room-membe","acts","actStrange","init","has","Ids","tBqQR","0|9|1|7|5|","log","getContact","mkdirp","ranger-ali","sCache","fault",".wechaty","delete","sep","vokeCache","getRoomMem","silly","hasRoom","uYXfl","2304368KrzGEG","311962SCvWSR","  cachedir","2jzlroE","lru-cache","close()","ias","set","ber","getLabelLi","pCache","[CacheMana","oad","CacheManag","se(%s, %s)","RevokeInfo","setMessage","all","4964663xSBlQj","close() ca","path","LRUCache","initCache(","erty","hasContact","4|3|6|2|8","flash-stor","puppet-pad","setFriends","9VZcmAV","getMessage","Count","size"];return(_0x2e30=function(){return t})()}class CacheManager{[_0x4d0dfc(285)];["_messageCa"+_0x4d0dfc(273)];[_0x4d0dfc(250)+_0x4d0dfc(315)];[_0x4d0dfc(278)+"che"];["_contactSe"+_0x4d0dfc(255)];[_0x4d0dfc(275)+_0x4d0dfc(227)+_0x4d0dfc(310)];["_roomCache"];["_roomMembe"+_0x4d0dfc(237)];["_roomInvit"+_0x4d0dfc(231)];[_0x4d0dfc(232)+_0x4d0dfc(330)];["_labelList"];constructor(t){this[_0x4d0dfc(285)]=t}async[_0x4d0dfc(301)](){const c=_0x4d0dfc,d={Cwlub:c(268)+c(261)+c(291)+c(334),ThfLS:c(286)+c(292),gGiBa:c(312),hSOgt:function(t,a){return t*a},uazUC:function(t,a){return t*a},cSBtF:"contact-ra"+c(358),zDbfP:function(t,a){return t*a},rjTIs:c(247)+c(309)+"as",uYXfl:c(353)+c(277),CaWkh:c(298)+"r-raw-payload"};if(this[c(265)+c(273)])throw new Error(d.ThfLS);var t=path_1[c(257)][c(354)](os_1[c(257)][c(276)](),path_1.default[c(314)],d.gGiBa,c(347)+c(279),path_1[c(257)][c(314)],this[c(285)],path_1[c(257)].sep),a=(await fs_extra_1.default[c(272)](t)||await fs_extra_1[c(257)][c(308)](t),this[c(265)+"che"]=new lru_cache_1[c(341)]({dispose(t,a){var e=c;wechaty_puppet_1[e(306)][e(317)](PRE,"constructo"+e(261)+"ions.dispo"+e(334),t,JSON.stringify(a))},max:1e3,ttl:d.hSOgt(6e4,60)}),this[c(250)+c(315)]=new lru_cache_1[c(341)]({dispose(t,a){var e=c;wechaty_puppet_1[e(306)][e(317)](PRE,d[e(290)],t,JSON.stringify(a))},max:1e3,ttl:d[c(297)](d[c(264)](1e3,60),60)}),this[c(278)+c(273)]=new flash_store_1[c(280)](path_1.default[c(354)](t,d.cSBtF)),this[c(296)+"archCache"]=new lru_cache_1[c(341)]({dispose(t,a){var e=c;wechaty_puppet_1[e(306)][e(317)](PRE,d.Cwlub,t,JSON.stringify(a))},max:1e3,ttl:d[c(287)](d[c(264)](1e3,60),60)}),this[c(275)+"rangerAlia"+c(310)]=new flash_store_1[c(280)](path_1[c(257)][c(354)](t,d[c(270)])),this[c(260)]=new flash_store_1[c(280)](path_1[c(257)][c(354)](t,d[c(319)])),this["_roomMembe"+c(237)]=new flash_store_1[c(280)](path_1.default[c(354)](t,d[c(242)])),this[c(294)+c(231)]=new flash_store_1[c(280)](path_1[c(257)][c(354)](t,"room-invitation-raw-"+c(244))),this[c(232)+"pCache"]=new flash_store_1[c(280)](path_1[c(257)][c(354)](t,c(241)+c(263)+"ad")),await this[c(278)+c(273)][c(352)]);wechaty_puppet_1.log.silly(PRE,c(342)+c(267)+a+(" Contacts,"+c(322))+'="'+t+'"')}async["close"](){var a=_0x4d0dfc,e={tBqQR:a(266)+a(235)+a(284),sMazq:a(339)+a(251)+"."};if(wechaty_puppet_1[a(306)][a(317)](PRE,a(325)),this[a(278)+a(273)]&&this[a(275)+"rangerAlia"+a(310)]&&this[a(262)+"rCache"]&&this[a(260)]&&this[a(232)+"pCache"]&&this[a(294)+a(231)]&&this[a(265)+a(273)]){var c=(a(305)+a(345)).split("|");let t=0;for(;;){switch(c[t++]){case"0":wechaty_puppet_1[a(306)][a(317)](PRE,e[a(304)]);continue;case"1":this[a(278)+a(273)]=void 0;continue;case"2":this[a(265)+"che"]=void 0;continue;case"3":this[a(232)+a(330)]=void 0;continue;case"4":this[a(260)]=void 0;continue;case"5":this[a(262)+a(237)]=void 0;continue;case"6":this[a(294)+a(231)]=void 0;continue;case"7":this[a(275)+"rangerAlia"+a(310)]=void 0;continue;case"8":wechaty_puppet_1[a(306)][a(317)](PRE,e.sMazq);continue;case"9":await Promise[a(337)]([this["_contactCa"+a(273)].close(),this["_contactSt"+a(227)+"sCache"][a(240)](),this._roomMemberCache[a(240)](),this[a(260)][a(240)](),this["_friendshi"+a(330)][a(240)](),this[a(294)+a(231)][a(240)]()]);continue}break}}else wechaty_puppet_1.log[a(317)](PRE,a(339)+"che not exist.")}async[_0x4d0dfc(350)](t){var a=_0x4d0dfc;return this[a(265)+a(273)].get(t)}async[_0x4d0dfc(336)](t,a){var e=_0x4d0dfc;await this[e(265)+"che"][e(327)](t,a)}async[_0x4d0dfc(253)](t){var a=_0x4d0dfc;return this["_messageCa"+a(273)][a(302)](t)}async["getMessage"+_0x4d0dfc(335)](t){var a=_0x4d0dfc;return this[a(250)+a(315)][a(238)](t)}async[_0x4d0dfc(336)+_0x4d0dfc(335)](t,a){var e=_0x4d0dfc;await this["_messageRe"+e(315)][e(327)](t,a)}async[_0x4d0dfc(307)](t){return this[_0x4d0dfc(278)+"che"].get(t)}async[_0x4d0dfc(288)](t,a){var e=_0x4d0dfc;await this["_contactCa"+e(273)][e(327)](t,a)}async[_0x4d0dfc(248)+_0x4d0dfc(233)](t){var a=_0x4d0dfc;await this[a(278)+"che"][a(313)](t)}async[_0x4d0dfc(307)+_0x4d0dfc(303)](){var t=_0x4d0dfc,a=[];for await(const e of this[t(278)+t(273)][t(293)]())a[t(239)](e);return a}async[_0x4d0dfc(357)+_0x4d0dfc(299)](){var t=_0x4d0dfc,a=[];for await(const e of this[t(278)+t(273)].values())a[t(239)](e);return a}async[_0x4d0dfc(344)](t){var a=_0x4d0dfc;return this[a(278)+a(273)].has(t)}async["getContact"+_0x4d0dfc(351)](){var t=_0x4d0dfc;return this["_contactCa"+t(273)][t(352)]}async["getContact"+_0x4d0dfc(246)](t){var a=_0x4d0dfc;return this[a(296)+"archCache"][a(238)](t)}async[_0x4d0dfc(288)+_0x4d0dfc(246)](t,a){var e=_0x4d0dfc;await this._contactSearchCache[e(327)](t,a)}async[_0x4d0dfc(344)+_0x4d0dfc(246)](t){var a=_0x4d0dfc;return this._contactSearchCache[a(302)](t)}async[_0x4d0dfc(307)+"StrangerAl"+_0x4d0dfc(326)](t){var a=_0x4d0dfc;return this[a(275)+"rangerAlia"+a(310)][a(238)](t)}async[_0x4d0dfc(288)+_0x4d0dfc(243)+_0x4d0dfc(326)](t,a){var e=_0x4d0dfc;await this[e(275)+e(227)+e(310)].set(t,a)}async[_0x4d0dfc(248)+_0x4d0dfc(300)+_0x4d0dfc(356)](t){var a=_0x4d0dfc;await this[a(275)+a(227)+a(310)].delete(t)}async[_0x4d0dfc(230)](t){return this._roomCache.get(t)}async["setRoom"](t,a){var e=_0x4d0dfc;await this._roomCache[e(327)](t,a)}async[_0x4d0dfc(271)](t){var a=_0x4d0dfc;await this[a(260)][a(313)](t)}async[_0x4d0dfc(283)](){var t=_0x4d0dfc,a=[];for await(const e of this._roomCache.keys())a[t(239)](e);return a}async["getRoomCount"](){return this._roomCache.size}async[_0x4d0dfc(318)](t){var a=_0x4d0dfc;return this._roomCache[a(302)](t)}async[_0x4d0dfc(316)+_0x4d0dfc(328)](t){var a=_0x4d0dfc;return this._roomMemberCache[a(238)](t)}async[_0x4d0dfc(245)+"ber"](t,a){await this[_0x4d0dfc(262)+"rCache"].set(t,a)}async[_0x4d0dfc(271)+_0x4d0dfc(234)](t){var a=_0x4d0dfc;await this[a(262)+a(237)][a(313)](t)}async[_0x4d0dfc(236)+_0x4d0dfc(355)](t){return this[_0x4d0dfc(294)+"ationCache"].get(t)}async["setRoomInv"+_0x4d0dfc(355)](t,a){var e=_0x4d0dfc;await this[e(294)+e(231)][e(327)](t,a)}async[_0x4d0dfc(271)+_0x4d0dfc(254)](t){var a=_0x4d0dfc;await this[a(294)+a(231)][a(313)](t)}async["getFriends"+_0x4d0dfc(269)+_0x4d0dfc(332)](t){var a=_0x4d0dfc;return this[a(232)+a(330)][a(238)](t)}async[_0x4d0dfc(348)+"hipRawPayl"+_0x4d0dfc(332)](t,a){var e=_0x4d0dfc;await this[e(232)+e(330)][e(327)](t,a)}[_0x4d0dfc(329)+"st"](){return this[_0x4d0dfc(259)]}["setLabelList"](t){this[_0x4d0dfc(259)]=t}}function _0x2db7(t,a){const e=_0x2e30();return(_0x2db7=function(t,a){return t-=225,e[t]})(t,a)}exports[_0x4d0dfc(333)+"er"]=CacheManager;