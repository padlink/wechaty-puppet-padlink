"use strict";const _0x54289b=_0x45c4;function _0x4d88(){const e=["setRoomMem","close()","r-raw-payl","hasRoom","getRoom","setUUID","default","72jETYwp","join","[CacheMana","786529Gazgch","flash-stor","_roomCache","silly","pathExists","uuid","_tokenCach","2736606jhtZxo","rCache","27705280NEawHg","FlashStore","get","Member","_userName","room-membe","server-cac","cPcuh","1283120eyTFmG","already in","deleteToke","deleteRoom","sep","__importDe","init","all","7810812KIfcCf","oad","size","ayload","2rUDDXy","fs-extra","defineProp","ppet",".wechaty","set","che closed","__esModule","erty","close","3171973CtWSfB","ger]","getRoomCou","room-raw-p","close() cl","delete","5770290QITuHt","12fjDbkN","es ...","has","keys","_roomMembe","log","path","che not ex","ftgEx","close() ca","CacheManag","ber"];return(_0x4d88=function(){return e})()}!function(){for(var e=_0x45c4,t=_0x4d88();;)try{if(985656==+parseInt(e(541))*(parseInt(e(502))/2)+parseInt(e(548))/3+-parseInt(e(498))/4+-parseInt(e(518))/5+-parseInt(e(519))/6*(-parseInt(e(512))/7)+parseInt(e(490))/8*(-parseInt(e(538))/9)+parseInt(e(482))/10)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();var __importDefault=this&&this[_0x54289b(495)+"fault"]||function(e){var t=_0x54289b;return e&&e[t(509)]?e:{default:e}};Object[_0x54289b(504)+_0x54289b(510)](exports,_0x54289b(509),{value:!0}),exports[_0x54289b(529)+"er"]=void 0;const fs_extra_1=__importDefault(require(_0x54289b(503))),os_1=__importDefault(require("os")),path_1=__importDefault(require(_0x54289b(525))),wechaty_puppet_1=require("wechaty-pu"+_0x54289b(505)),flash_store_1=require(_0x54289b(542)+"e"),PRE=_0x54289b(540)+_0x54289b(513);function _0x45c4(e,t){const a=_0x4d88();return(_0x45c4=function(e,t){return e-=481,a[e]})(e,t)}class CacheManager{[_0x54289b(486)];[_0x54289b(547)+"e"];[_0x54289b(543)];[_0x54289b(523)+_0x54289b(481)];constructor(e){this[_0x54289b(486)]=e}async[_0x54289b(496)](){var e=_0x54289b,t={rNPVf:e(491)+"itialized",qwUwH:e(506),cPcuh:e(488)+"he",ftgEx:e(487)+e(533)+e(499)};if(this[e(543)])throw new Error(t.rNPVf);var a=path_1[e(537)][e(539)](os_1[e(537)].homedir(),path_1[e(537)][e(494)],t.qwUwH,t[e(489)],path_1.default.sep,this[e(486)],path_1[e(537)][e(494)]);await fs_extra_1[e(537)][e(545)](a)||await fs_extra_1[e(537)].mkdirp(a),this._tokenCache=new flash_store_1.FlashStore(path_1[e(537)][e(539)](a,e(546))),this[e(543)]=new flash_store_1[e(483)](path_1[e(537)][e(539)](a,e(515)+e(501))),this[e(523)+e(481)]=new flash_store_1[e(483)](path_1[e(537)][e(539)](a,t[e(527)]))}async["close"](){var e=_0x54289b,t={FrAlp:e(516)+"osing cach"+e(520)};wechaty_puppet_1[e(524)][e(544)](PRE,e(532)),this[e(523)+e(481)]&&this[e(543)]&&this[e(547)+"e"]?(wechaty_puppet_1[e(524)][e(544)](PRE,t.FrAlp),await Promise[e(497)]([this[e(523)+e(481)][e(511)](),this[e(543)][e(511)](),this._tokenCache.close()]),this["_roomMembe"+e(481)]=void 0,this[e(543)]=void 0,this[e(547)+"e"]=void 0,wechaty_puppet_1.log[e(544)](PRE,e(528)+e(508)+".")):wechaty_puppet_1.log[e(544)](PRE,e(528)+e(526)+"ist.")}async[_0x54289b(535)](e){var t=_0x54289b;return this._roomCache[t(484)](e)}async["setRoom"](e,t){var a=_0x54289b;await this[a(543)][a(507)](e,t)}async[_0x54289b(493)](e){var t=_0x54289b;await this[t(543)][t(517)](e)}async["getRoomIds"](){var e=_0x54289b,t=[];for await(const a of this[e(543)][e(522)]())t.push(a);return t}async[_0x54289b(514)+"nt"](){var e=_0x54289b;return this[e(543)][e(500)]}async[_0x54289b(534)](e){var t=_0x54289b;return this[t(543)][t(521)](e)}async["getRoomMem"+_0x54289b(530)](e){var t=_0x54289b;return this["_roomMembe"+t(481)][t(484)](e)}async[_0x54289b(531)+_0x54289b(530)](e,t){var a=_0x54289b;await this[a(523)+a(481)][a(507)](e,t)}async[_0x54289b(493)+_0x54289b(485)](e){var t=_0x54289b;await this[t(523)+t(481)][t(517)](e)}async["getUUID"](e){var t=_0x54289b;return this[t(547)+"e"][t(484)](e)}async[_0x54289b(536)](e,t){var a=_0x54289b;await this[a(547)+"e"][a(507)](e,t)}async[_0x54289b(492)+"n"](e){var t=_0x54289b;await this[t(547)+"e"][t(517)](e)}}exports[_0x54289b(529)+"er"]=CacheManager;