const _0xb417a7=_0x2394;!function(){for(var e=_0x2394,t=_0x17b9();;)try{if(178914==+parseInt(e(641))*(-parseInt(e(665))/2)+-parseInt(e(753))/3*(-parseInt(e(875))/4)+-parseInt(e(672))/5+-parseInt(e(600))/6*(-parseInt(e(605))/7)+-parseInt(e(778))/8+-parseInt(e(612))/9*(parseInt(e(736))/10)+-parseInt(e(966))/11*(-parseInt(e(579))/12))break;t.push(t.shift())}catch(e){t.push(t.shift())}}();import{SyyRequest}from"../index.js";import _0x157450 from"cuid";import{Polling}from"../utils/polling.js";import _0x23df3a from"ws";import{Response,SendAppMessageResponse,ChatRoomMember,Contact,Message,Label}from"../../map/index.js";import{CacheManager}from"../../cache-manager.js";function _0x17b9(){const e=["wxid_kxbss","er_name","mticket","mberDetail","setMessage","123213","title","lPdyY","2fce4b0204","/Tools/Cdn","mContact","NickName","filter","onQrCodeEv","otDXb","01000204cf","msg_type","getChatCon","send_text","tCardMessa","tRoomMembe","mTYqb","ick_name","Out?key=","oYOse","ist","get","gcmkV","e attempts","attachid","sXtGO","WebSocket ","Signature","435372d346","effective_","remark","getMinutes","v1_7wKTlnL","wx_message","sagewenjia","forwardMes","qmEEY","463352d636","/group/Sen","LoginStatu","hareCardMe","poll_messa","sendContac","ugOsi","c9eea8140f","o8SkgbwX5o","username","setContact","46cd881fa9","callback","inviter_us","ber","0270823229","bwNKS","FLwZn","TbvVM","COREf","endAppMess","load?key=","GetLoginSt","aeskey","proxy","ws/GetSync","ssage","getChatroo","wIWBL","token","144WAFBvb","mThumb","baseRespon","cc2100250f","userName","to_user_na"," failed, r","XVDSl","setAvatar","str","labelID","setAtList","9da1c45bee","chatrooms","endImageNe","2764_17223","data:image","getSeconds","202032f591","dbjyI","01000400","11922GQxKdP","setTousern","me?key=","/login/Get","0128080302","574rZqzOv","poll","_cacheMgr","2d34303430","poll_heart","revokeinfo","logout","2781162KoJcEi","ret","chatRoomOw","xvYIA","TSxKU","700_4dfcfc","ogin","b02041424e","test","stringify","getHours","setRoom","ge_timer","errpage?ap","Data","passname","msgsource","eiPTP","TqTNq","dSzhP","wkhyy","/Tools/Dow","er multipl","Connected ","rofile?key","ejDSK","sendImageM","setId","age?key=","1187NQcBuB","Video","actRemark","45aa6d4173","getFullYea","includes","to reconne","padStart","cdnthumbur","mMembers","toObject","/user/Modi","7009346818","endTextMes","2f591b0204","4dfcfca645","m?key=","getTime","GPuzYCdPvw","selfContac","e1535755b3","d68d867756","iRZHS","JcTWz","50AOlopr","ype=3#wech","新建文本文档 (2)","0343032396","bdUQW","ZTgfkeB","msg","1210535DkbKjc","r?key=","eMiniProgr","failed, at","setDisplay","GbsFkl8KMI","uuid","hFhPz","nouncement","140f3e_1","connection","RasdB","url","setContent","ggFOpF8kP4","nmg7opHS3F","wxid_yqw0i","chatroom_n","n code","2d34613733","addContact","xbIRu","339652d626","qbZJB","OjpV/n9TRf","jpg","contactLis","cdnmidimgu","userInfoEx","978020466a","chatroomMe","uXbLS","send","tact","etMsgVoice","0514000502","toString","setFromuse","P+4382v9Q7","name","xpkNw","setNicknam","puppet_pad","appattach","KpKWt","ChatroomMe","4c505700","stop","45df3d1bd8","Image","/user/Upda","etContact:","iteChatroo","8177193250","Msg?key=","evQiA","wMessage?k","setChatRoo","getUsernam","5efa5257be","IfkTb","Nwjzz","dbUhZ","string","10YeQgil","setEncrypt","deNew","cdnattachu",".txt","view","184","res","mQrCode","setAntispa","mkHsl","TSeGu","ooLaQ","cess","ner","updateCont","open","246ViqoTR","nvNFW","img","data","ping","PZQwR","member_dat","HeartBeat ",".weixin.qq","userInfo","yYryF","kAwBb","tYjwO","mberList","thumbURL","Status","ime","184 B","state","7363061356","UYDj/Zspdy","user_name","from_user_","sendFileMe","onLoginSuc","1863760JSdNbx","sendVoiceM","ey=","setChatroo","appmsg","encryptUse","rName","/Label/Del","xCPTW","pUpHB","qr_arr","signature","数据出错","setMsgcont","VMnxJ","JwlTk","7b48ea7802","ing JSON:","eEmoji","getMessage","65264","new_msg_id","nickName","RoomMember","rname","Code","tailsList?","display_na","msg_source","Gniin","3052020100","options","/group/Get","044b304902","join","jyPxmdi+Gj","2d34633965","405004c505","time","close","setCreatet","2d63643537","QRCode","getChatRoo","/user/GetP","@cdn_30570","_name","mhnOj","2d62633232","init","/group/Inv","rifyUser?k","antispam_t","endVideo?k","2d38363730","/group/Qui","4020405140","/label/Mod","/user/SetS","ckLoginSta","ateChatRoo","labelName","/friend/De","o?key=","ContactLab","DzGtS","sage","6336336376","SSpnS","mowneruser","ent","getLoginCo","et server","Ohpxh","deleteChat","fyRemark?k","jVgk1sYTPs","teNickName","roomId","oup?key=","tFriendRel","/message/S","0424373630","totallen","getRoomMem","vidAQMyHYi","UXPfg","ax_count","at_redirec","0467b1c1cf","dbb0e647bd","nick_name","xlUFk","updateSelf","提取的 URL:","DownloadIm","setRemark","17092hHFmgD","Voice","loginErrMs","addLabel","login"," closed. A","8770c850ac","getSecondL","KHuAc","106112608","21376","Xssko","setName","atus","age","?key=","descriptio","rrcmoyd12_","setGender","204cfb2499","jtYab","msg_825269","mmemberLis","82a9c9eea8","/login/Che","eNew?key=","slrWE","70f5fd6346","0050201000","port","abs","6135646335","eLink","endCDNFile","Attach","ignature?k",".com/mp/wa","small_head","sendMessag","100","sex","mAnnouncem","tChatroom?","747","ISvqpWoFoE","kmNAS","Room","mmaxcount","now","2d61343266","3239663363","ClLTDHZQ6R","setRoomMem","embers","split","8yjkqx122","/group/Set","3d22d51b80","labelPairL","Error pars","setMsgid","_client","icket","nloadFile?","AttachThum","VVTot","push","lContact?k","essage","/friend/Ve","removeLabe","endEmojiMe","/label/Get","/friend/Ge","revokeMess","getMyConta","getRoomIds","post","XqQYZ","fOrJu","nIntoUrlGr","inviteChat","79izHT2VeB","0100040500","p;upgradet","20100044b3","ws://local","setSignatu","jKals","JHrez","acceptUser","439417cjttts","el?key=","poll_chang","contact","emit","d1f21482a9","删除失败，检测机器是","etrying...","6664360204","76f997e791","setUsernam","否是管理员","setInviter","getContact","DZCAW","KFvDJ","&amp;type=","GhWQz","setType","clientmsgi","0490201000","wZBYZ","hHcMc","deleteCont","QrCodeUrl","wxid","mgUrl","videomsg","smallHeadI","getAllChat","getLabelLi","error","elation","ember_list","mpt ","ssage?key=","sage?key=","/group/Cre","rTKwh","903f359f6d","key=","_img_url","mgUIm","tContactDe","IOmUm","AntispamTi","onSync","ifyLabel?k","1424e97802","owner_user","账号在线状态良好！","sendVideoM","llSRJ","VDXlx","/Tools/Upl","ame","deByFirst","chatroomme","failed aft","332322d343","EhIGq","checkLogin","atuserlist","/message/G","WslDU","buffer","evokeMsg?k","createChat","3057020100","b249920203","Label","length","JnKns","log","chatroom_m","LoginQrCod","akluN"];return(_0x17b9=function(){return e})()}import{jsonToXml,xmlToJson}from"../../utils/xml-to-json.js";function _0x2394(e,t){const a=_0x17b9();return(_0x2394=function(e,t){return e-=453,a[e]})(e,t)}class Api{[_0xb417a7(607)];[_0xb417a7(936)];[_0xb417a7(578)];[_0xb417a7(573)];[_0xb417a7(678)];["wxid"];["callback"];[_0xb417a7(788)];[_0xb417a7(553)+_0xb417a7(624)];constructor(e){this[_0xb417a7(936)]=e,this.qr_arr=[]}async["init"](){var e=_0xb417a7;this[e(607)]=new CacheManager(this[e(578)]),await this[e(607)][e(827)]()}async[_0xb417a7(879)](e,t){var a=_0xb417a7,n={kmNAS:a(714)+"plus_",pUpHB:function(e,t){return e==t},tpNcF:a(480)},t=(this[a(561)]=t,this[a(936)].token[a(929)](n[a(920)])[1]);this[a(578)]=t,await this.init();try{var s=await this[a(571)+"atus"]();n[a(787)](s[a(626)][a(877)+"g"],n.tpNcF)&&this[a(882)+a(618)]()}catch(e){this["getLoginCo"+a(486)]()}}async[_0xb417a7(849)+_0xb417a7(738)](){var e=_0xb417a7;return this[e(573)]&&(this.proxy[e(558)],this.proxy[e(627)],this.proxy.ip,this[e(573)][e(904)]),SyyRequest[e(952)]({url:"/login/Get"+e(505)+e(900)+this[e(578)],data:{Proxy:Proxy}})}async["checkLogin"+_0xb417a7(768)](){var e=_0xb417a7;return SyyRequest[e(533)]({url:e(899)+e(837)+"tus?key="+this[e(578)],data:{}})}async[_0xb417a7(571)+_0xb417a7(888)](e=5){var t=_0xb417a7,a={akluN:function(e,t){return e<t},oYOse:t(760)+t(488)+t(634)+t(535)};let n=0;for(;a[t(506)](n,e);){try{var s=await SyyRequest[t(533)]({url:t(603)+t(551)+"s?key="+this.token,data:{}});if("账号在线状态良好！"==s.Data?.loginErrMsg)return s}catch(e){}n++,console.log("Heart atte"+t(464)+n+(t(585)+t(973)))}throw new Error(a[t(531)])}["getLoginCo"+_0xb417a7(486)]=async()=>{const s=_0xb417a7,r={lPdyY:function(e,t){return e!=t},XqQYZ:function(e,t){return t<e},cirlh:function(e,t,a){return e(t,a)},eLOAb:function(e,t){return e*t},JHrez:function(e,t){return e==t},ugOsi:function(e,t){return e==t},TbvVM:function(e,t){return e(t)},gcmkV:"5|4|0|3|1|2",IfkTb:function(e,t){return e==t},HtgJz:"eee",SSpnS:"res_code",EbckS:function(e,t){return e==t},DzGtS:s(872)};console[s(503)](r.HtgJz);let i=this[s(561)],e=await this[s(849)+s(738)]();if(console[s(503)](r[s(846)],e),r.EbckS(e[s(803)],200)){var t=new URL(e[s(626)][s(454)]).searchParams.get(s(684));console[s(503)](r[s(843)],t),this[s(788)][s(646)](t)||(i.onOneClickEvent({status:1,imageUrl:t}),this[s(788)][s(941)](t));const o=new Polling;let n=null;o[s(606)](3e3,async()=>{const t=s;var e=await this[t(491)+t(768)]();if(console[t(503)](t(491)+t(768),e),!n&&r[t(514)](e.Data?.["effective_"+t(816)],"undefined")&&r[t(953)](e[t(626)]?.[t(541)+t(816)],230)&&(n=r.cirlh(setTimeout,async()=>{var e=t;o[e(719)](),i["onQrCodeEv"+e(848)]({status:5}),await this[e(849)+"deByFirst"]()},r.eLOAb(e[t(626)][t(541)+t(816)],1e3))),200==e.Code){if(r[t(964)](e[t(626)].state,1)&&i[t(520)+t(848)]({status:2}),r[t(555)](e[t(626)].state,4)&&i[t(520)+t(848)]({status:4}),2==e[t(626)][t(771)]){o[t(719)](),n&&(r[t(567)](clearTimeout,n),n=null),i[t(520)+t(848)]({status:3}),this[t(455)]=e[t(626)].wxid;try{var a=r[t(534)][t(929)]("|");let e=0;for(;;){switch(a[e++]){case"0":await i[t(777)+t(749)](this[t(936)][t(660)+"t"]);continue;case"1":this.poll_change_contact(3e3);continue;case"2":this.poll_heart();continue;case"3":await i[t(476)]({getContactList(){return[]},getMessageList(){return[]}});continue;case"4":this[t(936)][t(660)+"t"]=await this[t(950)+"ct"]();continue;case"5":this[t(545)]();continue}break}}catch(e){}}}else r[t(732)](e[t(803)],-8)})}};async["getSecondL"+_0xb417a7(618)](){var t=_0xb417a7;try{this[t(545)](),this[t(936)][t(660)+"t"]=await this.getMyContact(),await this[t(561)]["onLoginSuc"+t(749)](this._client.selfContact),await this[t(561)][t(476)]({getContactList(){return[]},getMessageList(){return[]}}),this[t(968)+"e_contact"](3e3),this.poll_heart()}catch(e){console[t(461)]("HeartBeat "+t(675)+"tempting to get logi"+t(690),e),await this[t(849)+t(486)]()}}async[_0xb417a7(545)](){const c=_0xb417a7,u={BFIbb:c(635)+"to WebSock"+c(850),nvNFW:"utf-8",JwlTk:function(e,t){return e||t},fOrJu:function(e,t){return e(t)},UXPfg:function(e,t){return e(t)},VVTot:"message",ooLaQ:c(934)+c(795),mTYqb:function(e,t){return e+t},mhnOj:function(e,t){return e(t)},mkHsl:function(e,t){return e(t)},slrWE:function(e,t,a){return e(t,a)},COREf:c(752),Ohpxh:c(817),XaXgG:"error"},e=c(961)+"host:8848/"+c(574)+c(726)+this.token,t=new _0x23df3a(e);t.on(u[c(568)],()=>{var e=c;t[e(704)](JSON.stringify({type:e(757),timestamp:Date[e(923)]()})),console.log(u.BFIbb)}),t.on(u[c(940)],async e=>{var t=c,e=e[t(708)](u[t(754)]);try{var a=JSON.parse(e);if(a){var n,s=a,r=(new Message)[t(709)+t(802)](s[t(775)+t(711)][t(588)])[t(601)+t(485)](s[t(584)+"me"][t(588)])[t(639)](s[t(799)])[t(984)](s[t(523)])[t(818)+t(769)](s.create_time),i=/@chatroom$/.test(s[t(775)+"name"].str),o=/@chatroom$/[t(620)](s.to_user_name[t(588)]);let e=[];u[t(793)](i,o)&&(this._cacheMgr?.[t(623)](s["from_user_"+t(711)].str||s[t(584)+"me"][t(588)],!0),n=(await u[t(954)](xmlToJson,s.msg_source))[t(628)]?.[t(492)]?(await u[t(864)](xmlToJson,s[t(806)])).msgsource.atuserlist[t(929)](","):[],e=n[t(519)](e=>""!==e)),r[t(685)](s.content.str)[t(590)](e),console[t(503)]("长连接message"),this[t(936)].emit(u[t(940)],[r])}}catch(e){console[t(461)](u[t(748)],e)}}),t.on(u[c(851)],()=>{var e=c,t=new Date,t=t[e(645)+"r"]()+"-"+u.fOrJu(String,u[e(528)](t.getMonth(),1))[e(648)](2,"0")+"-"+String(t.getDate())[e(648)](2,"0")+" "+u[e(864)](String,t[e(622)]()).padStart(2,"0")+":"+u[e(825)](String,t[e(543)]())[e(648)](2,"0")+":"+u[e(746)](String,t[e(596)]())[e(648)](2,"0");console[e(503)](t),console[e(503)](e(538)+e(682)+e(880)+"ttempting "+e(647)+"ct..."),u[e(901)](setTimeout,this[e(545)],0)}),t.on(u.XaXgG,e=>{var t=c;console.error(t(538)+"error:",e)})}[_0xb417a7(609)](){const e=_0xb417a7,a={KFvDJ:"kickout",GhWQz:function(e,t){return e*t},jpnAb:function(e,t){return e*t}},t=new Polling;t[e(606)](a[e(983)](a.jpnAb(2.5,60),1e3),async()=>{var t=e;try{await this["GetLoginSt"+t(888)]()}catch(e){await this._cacheMgr?.[t(817)](),this[t(607)]=void 0,this[t(936)].emit(a[t(981)],"")}})}[_0xb417a7(968)+"e_contact"]=async t=>{for(var e=_0xb417a7,a={tYjwO:function(e,t){return t<e},xZbPE:function(e,t){return e!==t},hFhPz:function(e,t){return e<t},iRZHS:function(e,t){return e-t},xbIRu:function(e,t){return e!=t},mgUIm:e(969)};;){try{var n=await this[e(607)]?.[e(951)]();if(!n)return;for(const c of n)try{var s,r,i=await this[e(821)+"mContact"](c),o=await this[e(607)]?.[e(862)+e(563)](c);o&&a[e(765)](i["getChatroo"+e(897)+"t"]().length,0)?(s=o,r=i[e(651)]()[e(487)+e(766)],(a.xZbPE(s[e(501)],r.length)&&a[e(679)](Math[e(905)](a[e(663)](s[e(501)],r.length)),3)||a[e(693)](JSON[e(621)](s),JSON.stringify(r)))&&(this._cacheMgr?.[e(927)+"ber"](c,i[e(651)]()[e(487)+"mberList"]),this[e(936)][e(970)](a[e(472)],[i]))):0!==i[e(576)+e(897)+"t"]().length&&this[e(607)]?.["setRoomMem"+e(563)](c,i[e(651)]()[e(487)+e(766)])}catch(e){}}catch(e){}await new Promise(e=>setTimeout(e,t))}};async[_0xb417a7(525)](e,t,a){var n=_0xb417a7,s={dSzhP:function(e){return e()},wkhyy:function(e){return e()}};await SyyRequest[n(952)]({url:n(859)+n(654)+n(466)+this[n(578)],data:{MsgItem:[{AtWxIDList:a,ImageContent:"",MsgType:0,TextContent:t,ToUserName:e}]}});return(new Response)[n(935)](s.dSzhP(_0x157450))[n(511)+n(610)]({clientmsgid:s[n(631)](_0x157450),newclientmsgid:s[n(632)](_0x157450),createtime:(new Date)[n(658)]()})}async[_0xb417a7(638)+"essage"](e,t,a){var n=_0xb417a7,s={PZQwR:function(e){return e()}};await SyyRequest.post({url:n(859)+n(593)+n(728)+n(780)+this.token,data:{MsgItem:[{AtWxIDList:a,ImageContent:t,MsgType:2,TextContent:"",ToUserName:e}]}});return(new Response)[n(935)](s[n(758)](_0x157450))[n(511)+n(610)]({clientmsgid:s.PZQwR(_0x157450),newclientmsgid:s[n(758)](_0x157450),createtime:(new Date).getTime()})}async[_0xb417a7(481)+_0xb417a7(943)](e,t,a){var n=_0xb417a7,s={RasdB:function(e){return e()},jKals:function(e){return e()}};await SyyRequest[n(952)]({url:"/message/S"+n(831)+n(780)+this[n(578)],data:{Base64:t,ImageBase64:n(595)+"/png;base64,"+a,PlayLength:0,ToWxid:e,Wxid:this[n(455)]}});return(new Response)[n(935)](s[n(683)](_0x157450))["setMessage"+n(610)]({clientmsgid:s[n(963)](_0x157450),newclientmsgid:s[n(963)](_0x157450),createtime:(new Date)[n(658)]()})}async[_0xb417a7(776)+_0xb417a7(575)](e){var t=_0xb417a7,a={dbjyI:function(e){return e()}};await SyyRequest[t(952)]({url:t(484)+"oadFile?key="+this.token,data:{Base64:e,Wxid:this[t(455)]}});return(new Response).setMsgid(a.dbjyI(_0x157450)).setMessagerevokeinfo({clientmsgid:a[t(598)](_0x157450),newclientmsgid:_0x157450(),createtime:(new Date)[t(658)]()})}async[_0xb417a7(913)+_0xb417a7(796)](e,t,a){var n=_0xb417a7,s={VMnxJ:function(e){return e()}};await SyyRequest[n(952)]({url:n(859)+n(946)+n(465)+this[n(578)],data:{EmojiList:[{EmojiMd5:t,EmojiSize:a,ToUserName:e}]}});return(new Response)[n(935)](s[n(792)](_0x157450))["setMessage"+n(610)]({clientmsgid:_0x157450(),newclientmsgid:s.VMnxJ(_0x157450),createtime:(new Date)[n(658)]()})}async[_0xb417a7(913)+_0xb417a7(907)](e,t,a){var n=_0xb417a7,s={Xssko:n(809),IOmUm:n(808)+n(811)+n(522)+n(499)+n(515)+n(794)+n(867)+"04243962366662663330"+n(924)+n(691)+n(832)+"2d303934633363333732"+n(974)+n(604)+n(599),JxVIa:"87f4ccec0d"+n(469)+"50f70635c634",JcTWz:"68f00893d3"+n(661)+n(881)+"b4",dbUhZ:n(885),ucqcw:n(914),jtYab:n(884),XCKFj:function(e,t){return e(t)},XVDSl:function(e,t){return e(t)},DZCAW:function(e){return e()},Nwjzz:function(e){return e()}},a=(console[n(503)](s[n(886)],a),{msg:{appmsg:{$:{appid:"",sdkver:"0"},title:a[n(513)],des:a[n(891)+"n"],action:n(741),type:"5",showtype:"0",content:"",url:a.url,dataurl:"",lowurl:"",lowdataurl:"",recorditem:"",thumburl:a[n(767)],messageaction:"",laninfo:"",extinfo:"",sourceusername:"",sourcedisplayname:"",commenturl:"",appattach:{totallen:"0",attachid:"",emoticonmd5:"",fileext:"",aeskey:"",cdnthumburl:s[n(474)],cdnthumbaeskey:s.JxVIa,cdnthumbmd5:s[n(664)],cdnthumblength:s[n(734)],cdnthumbwidth:s.ucqcw,cdnthumbheight:s.ucqcw},webviewshared:{publisherId:n(896)+n(564)+n(918),publisherReqId:s[n(895)]},weappinfo:{pagepath:"",username:"",appid:"",appservicetype:"0"},websearch:""},fromusername:"",scene:"0",appinfo:{version:"1",appname:""},commenturl:""}}),r=await s.XCKFj(jsonToXml,a),a=await s[n(586)](jsonToXml,{appmsg:a.msg[n(782)]});await SyyRequest[n(952)]({url:"/message/S"+n(569)+n(640)+this[n(578)],data:{AppList:[{ContentType:0,ContentXML:a,ToUserName:t}]}});return(new SendAppMessageResponse)[n(935)](s[n(980)](_0x157450))[n(511)+"revokeinfo"]({clientmsgid:_0x157450(),newclientmsgid:s[n(733)](_0x157450),createtime:(new Date)[n(658)]()})[n(791)+n(848)](r)}async["sendMessag"+_0xb417a7(674)+"am"](e,t){var a=_0xb417a7,n={lQcNi:a(741),eiPTP:a(697),LBAMa:a(868)+a(720)+a(932)+"73",kAwBb:a(731)+a(902)+a(975)+"29",ymwQj:a(798),loFWx:a(914),zsfuT:function(e,t){return e(t)},MvOGb:function(e,t){return e(t)},hHcMc:function(e){return e()}},{appid:t,description:s,iconUrl:r,shareId:i,thumbKey:o,thumbUrl:c,username:u,title:m,pagePath:l}=t,m={appmsg:{appid:t,title:m,action:n.lQcNi,type:"33",showtype:"0",url:"https://mp"+a(761)+a(911)+a(625)+"pid="+t+a(982)+"upgrade&am"+a(959)+a(666)+a(866)+"t",md5:a(644)+a(725)+"46cd881fa92d",sourcedisplayname:s,appattach:{totallen:"0",fileext:n[a(629)],filekey:n.LBAMa,cdnthumburl:c,aeskey:n[a(764)],cdnthumbaeskey:o,cdnthumbmd5:a(644)+a(725)+a(560)+"2d",encryver:"1",cdnthumblength:n.ymwQj,cdnthumbheight:n.loFWx,cdnthumbwidth:a(914)},webviewshared:{publisherReqId:"0"},weappinfo:{pagepath:l,username:u,appid:t,type:"2",weappiconurl:r,appservicetype:"0",shareId:i}}},s=await n.zsfuT(jsonToXml,m),c=await n.MvOGb(jsonToXml,{msg:m});await SyyRequest[a(952)]({url:"/message/S"+a(569)+a(640)+this[a(578)],data:{AppList:[{ContentType:0,ContentXML:s,ToUserName:e}]}});return(new SendAppMessageResponse)[a(935)](_0x157450())[a(511)+a(610)]({clientmsgid:n[a(988)](_0x157450),newclientmsgid:_0x157450(),createtime:(new Date)[a(658)]()})["setMsgcont"+a(848)](c)}async[_0xb417a7(547)+_0xb417a7(844)](e,t){var a=_0xb417a7,n={wIWBL:function(e,t){return e(t)},WslDU:function(e,t){return e(t)},FLwZn:function(e){return e()}},s=await n[a(577)](xmlToJson,t),s=await n[a(494)](jsonToXml,{appmsg:s[a(671)].appmsg});await SyyRequest[a(952)]({url:a(859)+"endAppMess"+a(640)+this[a(578)],data:{AppList:[{ContentType:0,ContentXML:s,ToUserName:e}]}});return(new SendAppMessageResponse).setMsgid(_0x157450())["setMessage"+a(610)]({clientmsgid:n[a(566)](_0x157450),newclientmsgid:_0x157450(),createtime:(new Date)[a(658)]()})[a(791)+a(848)](t)}async[_0xb417a7(547)+_0xb417a7(546)+"n"](e,t){var a=_0xb417a7,n={TSxKU:function(e,t){return e(t)},DEwiz:a(667)+a(740),qmEEY:a(742),tyrpT:"txt",TSeGu:a(823)+a(960)+a(986)+a(894)+a(597)+a(619)+a(701)+"8b32c04243"+a(772)+a(549)+a(540)+a(694)+a(489)+a(668)+a(845)+a(834)+a(903)+a(815)+a(617)+"a645d1f214"+a(898)+a(681),QOZaM:a(498)+a(811)+a(522)+a(499)+a(655)+a(478)+"0466a8b32c"+a(860)+a(906)+a(819)+a(814)+a(826)+a(608)+a(925)+"3637640204"+a(707)+a(958)+a(718),EhIGq:a(656)+a(971)+a(556)+"3e",VDXlx:a(688)+a(892)+a(594)+"31948",sXtGO:a(544)+a(773)+a(687)+"+nLFWQcFHcnJvZNQCfoFxVMjJr8zu/"+a(957)+a(710)+a(659)+a(926)+a(686)+"x5b2kETRF9bURmKeTyO6"+a(863)+a(813)+"kJzr34qhhd"+a(677)+a(854)+a(696)+"EIr056iMnf"+a(919)+a(557)+a(670),qbZJB:a(507)+a(930),JnKns:function(e){return e()}},s=await n[a(616)](jsonToXml,{msg:{appmsg:{sdkver:"0",title:n.DEwiz,des:a(770),type:"6",action:"view",appattach:{totallen:n[a(548)],fileext:n.tyrpT,attachid:n[a(747)],cdnattachurl:n.QOZaM,aeskey:n[a(490)],encryver:"0",filekey:n[a(483)],overwrite_newmsgid:a(653)+"105138159",fileuploadtoken:n[a(537)]},md5:a(582)+a(591)+a(662)+"bb",webviewshared:{},mpsharetrace:{hasfinderelement:"0"},secretmsg:{isscrectmsg:"0"}},fromusername:n[a(695)],scene:"1",appinfo:{version:"1"}}});await SyyRequest[a(952)]({url:a(859)+a(908)+"?key="+this[a(578)],data:{Content:s,ToWxid:e,Wxid:this.wxid}});return(new SendAppMessageResponse)[a(935)](n[a(502)](_0x157450))[a(511)+"revokeinfo"]({clientmsgid:n.JnKns(_0x157450),newclientmsgid:n[a(502)](_0x157450),createtime:(new Date)[a(658)]()})[a(791)+a(848)](t)}async[_0xb417a7(779)+_0xb417a7(943)](e,t,a){var n=_0xb417a7,s={xozzY:function(e){return e()},otDXb:function(e){return e()}};await SyyRequest[n(952)]({url:n(859)+"endVoice?k"+n(780)+this[n(578)],data:{ToUserName:e,VoiceData:t,VoiceFormat:4,"VoiceSecond,":0}});return(new Response)[n(935)](s.xozzY(_0x157450))["setMessage"+n(610)]({clientmsgid:_0x157450(),newclientmsgid:s[n(521)](_0x157450),createtime:(new Date)[n(658)]()})}async[_0xb417a7(459)+_0xb417a7(801)+"s"](){var e=_0xb417a7,t=[];for(const s of(await SyyRequest[e(952)]({url:"/",data:{type:10114}}))[e(756)][e(756)][e(592)]){var a=[];for(const r in s[e(702)+"mbers"])a[e(941)]((new ChatRoomMember)[e(976)+"e"](s["chatroom_m"+e(928)][r][e(774)]).setAvatar(s.chatroom_members[r]["small_head"+e(471)])[e(713)+"e"](s[e(504)+e(928)][r][e(869)])[e(978)+"username"](s[e(504)+e(928)][r][e(562)+e(508)])["setDisplay"+e(711)](s[e(504)+e(928)][r]?.[e(689)+e(529)]));var n=(new Contact)[e(976)+"e"](s[e(774)])[e(713)+"e"](s[e(869)]).setAvatar(s[e(912)+"_img_url"]).setGender(0).setSignature("")[e(874)](s[e(542)])[e(781)+e(922)](s[e(504)+e(865)])[e(781)+"mmemberList"](a)[e(781)+e(847)+e(711)](s[e(479)+e(824)]);t[e(941)](n)}return t}async[_0xb417a7(821)+_0xb417a7(650)](e){var t=_0xb417a7,e=await SyyRequest[t(952)]({url:"/group/Get"+t(717)+t(510)+t(890)+this[t(578)],data:{ChatRoomName:e}}),a=[];if(e.Data?.[t(759)+"a"][t(504)+t(463)])for(const n of e[t(626)][t(759)+"a"][t(504)+"ember_list"])a[t(941)]((new ChatRoomMember).setUsername(n[t(774)])[t(587)](n[t(912)+t(471)]).setNickname(n.nick_name)[t(676)+t(711)](n?.[t(805)+"me"]||""));return a}async[_0xb417a7(979)](e,t){var a=_0xb417a7,n=/@chatroom$/[a(620)](e)||/@openim$/[a(620)](e);let s;try{return s=n?await this[a(821)+a(517)](e):e==this[a(936)][a(660)+"t"][a(730)+"e"]()?this[a(936)][a(660)+"t"]:await this["getChatCon"+a(705)](e)}catch(e){throw console[a(461)]("Error in g"+a(723),e),e}}async[_0xb417a7(871)+_0xb417a7(518)](s){const r={GhnRf:function(e,t){return e(t)},hejlR:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{var n=await SyyRequest[a(952)]({url:a(722)+a(855)+a(890)+this.token,data:{Scene:0,Val:s}});r.GhnRf(e,n)}catch(e){r.hejlR(t,e)}})}async["updateSelf"+_0xb417a7(539)](s){const r={xCPTW:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{var n=await SyyRequest[a(952)]({url:a(836)+a(910)+a(780)+this.token,data:{Scene:0,Val:s}});r[a(786)](e,n)}catch(e){t(e)}})}async[_0xb417a7(979)+_0xb417a7(820)](e,t){const n={fjsPu:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{e(await SyyRequest[a(952)]({url:"/user/GetMyQrCode?key="+this.token,data:{Recover:!0,Style:8}}))}catch(e){n.fjsPu(t,e)}})}async[_0xb417a7(751)+_0xb417a7(643)](e,t){var a=_0xb417a7;await SyyRequest[a(952)]({url:a(652)+a(853)+a(780)+this.token,data:{RemarkName:t,UserName:e}})}async["GetFriendR"+_0xb417a7(462)](e){var t=_0xb417a7;return await SyyRequest[t(952)]({url:t(948)+t(858)+"ation?key="+this[t(578)],data:{UserName:e}})}async[_0xb417a7(692)](e,t,a){var n=_0xb417a7;await SyyRequest.post({url:n(944)+n(829)+n(780)+this[n(578)],data:{Scene:3,V3:e,V4:t,VerifyContent:a}})}async[_0xb417a7(453)+"act"](e){var t=_0xb417a7;await SyyRequest[t(952)]({url:t(840)+t(942)+"ey="+this[t(578)],data:{DelUserName:e}})}async[_0xb417a7(524)+_0xb417a7(705)](e){var t=_0xb417a7,e=(await SyyRequest[t(952)]({url:"/friend/Ge"+t(473)+t(804)+"key="+this[t(578)],data:{RoomWxIDList:[""],UserNames:[e]}}))[t(626)][t(698)+"t"][0],e=(console.log(t(969),e),(new Contact).setUsername(e[t(583)][t(588)]).setNickname(e[t(800)].str)[t(587)](e[t(458)+t(456)])[t(893)](e[t(915)])[t(962)+"re"](e[t(789)])[t(745)+t(509)](e[t(830)+t(937)]));return e}async[_0xb417a7(950)+"ct"](){const r={KlAEB:function(e,t){return e(t)},KHuAc:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{var n=(await SyyRequest[a(533)]({url:a(822)+a(636)+"="+this[a(578)],data:{}}))[a(626)],s=(new Contact).setUsername(n[a(762)][a(583)].str)[a(713)+"e"](n[a(762)][a(800)][a(588)])[a(587)](n[a(700)+"t"][a(458)+"mgUrl"]).setGender(n[a(762)].sex)[a(962)+"re"](n[a(762)][a(789)])[a(745)+a(509)](n[a(475)+"cket"]||"");r.KlAEB(e,s)}catch(e){r[a(883)](t,e)}})}async[_0xb417a7(821)+_0xb417a7(517)](r){const i=_0xb417a7,o={pqYuq:function(e,t){return e==t},xyxxd:i(512),MkkGm:function(e,t){return e(t)},xvYIA:i(790)};return new Promise(async(e,t)=>{var a,n=i,s=await SyyRequest[n(952)]({url:"group/GetChatRoomInf"+n(841)+this[n(578)],data:{ChatRoomWxIdList:[r]}});o.pqYuq(s[n(803)],200)&&s.Data[n(698)+"t"]?(s=s[n(626)].contactList[0],a=await this[n(821)+n(650)](r),a=(new Contact)[n(976)+"e"](s[n(583)]?.[n(588)])[n(713)+"e"](s[n(800)]?.[n(588)]||o.xyxxd).setAvatar(s[n(458)+n(456)])[n(893)](s[n(915)])[n(962)+"re"]("")[n(874)]("")[n(781)+n(922)](500)[n(781)+n(897)+"t"](a)["setChatroo"+n(847)+n(711)](s[n(614)+n(750)])[n(737)+n(558)](s[n(783)+n(784)]),o.MkkGm(e,a)):t(o[n(615)])})}async["acceptChatRoomInvitation"](e,t){var a=_0xb417a7;return SyyRequest[a(952)]({url:"/group/Sca"+a(955)+a(857)+this.token,data:{Url:t}})}async["quitChatRoom"](e){var t=_0xb417a7;return SyyRequest[t(952)]({url:t(833)+t(917)+"key="+this[t(578)],data:{ChatRoomName:e}})}async[_0xb417a7(797)+"Image"](r,e,i){const o={wZBYZ:function(e,t){return e(t)},yYryF:function(e,t){return e(t)}};return new Promise(async(t,e)=>{var a=_0x2394;try{var n=(await o[a(987)](xmlToJson,r))[a(671)][a(755)].$,s=await SyyRequest.post({url:a(859)+"endCdnDown"+a(570)+this[a(578)],data:{AesKey:n.aeskey,FileType:0,FileURL:n[a(699)+"rl"]}});o[a(763)](t,{imageType:i,imageData:s[a(626)][a(721)]})}catch(e){o[a(763)](t,e)}})}async["getMessage"+_0xb417a7(876)](e,t,a){var n=_0xb417a7,t=(await xmlToJson(t))[n(671)].voicemsg.$;return(await SyyRequest[n(952)]({url:n(493)+n(706)+n(890)+this[n(578)],data:{Bufid:t[n(985)+"d"],Length:0,NewMsgId:e,ToUserName:a}})).Data[n(756)][n(495)]}async[_0xb417a7(797)+_0xb417a7(642)](e,t,a){var n=_0xb417a7,s={uXbLS:function(e,t){return e(t)}},t=(await s[n(703)](xmlToJson,t))[n(671)][n(457)].$;return(await SyyRequest.post({url:n(493)+"etMsgVideo"+n(890)+this.token,data:{CompressType:0,FromUserName:"",MsgId:e,Section:{DataLen:s[n(703)](Number,t[n(501)]),StartPos:0},ToUserName:a,TotalLen:0}}))[n(626)][n(756)][n(495)]}async["getMessage"+_0xb417a7(909)](e,t){var a=_0xb417a7,n={xlUFk:function(e,t){return e(t)}},e=await n[a(870)](xmlToJson,e),s=e[a(671)].appmsg[a(715)];return(await SyyRequest[a(952)]({url:a(633)+a(938)+a(470)+this.token,data:{AppID:e[a(671)].appmsg.$.appid,AttachId:s[a(536)],DataLen:n[a(870)](Number,s[a(861)]),Section:{DataLen:0,StartPos:0},UserName:t,Wxid:this[a(455)]}}))[a(626)][a(756)].buffer}async[_0xb417a7(797)+"MiniProgra"+_0xb417a7(580)](e,t){var a=_0xb417a7,e=(await{TqTNq:function(e,t){return e(t)}}[a(630)](xmlToJson,e))[a(671)].appmsg.appattach;return(await SyyRequest[a(952)]({url:a(516)+"DownloadIm"+a(640)+this[a(578)],data:{FileAesKey:e[a(572)],FileNo:e[a(739)+"rl"],Wxid:this[a(455)]}})).Data[a(721)]}async[_0xb417a7(797)+_0xb417a7(939)+"b"](e,t){var a=_0xb417a7,e=(await xmlToJson(e))[a(671)][a(782)][a(715)];return(await SyyRequest.post({url:a(516)+a(873)+a(640)+this[a(578)],data:{FileAesKey:e[a(572)],FileNo:e[a(649)+"l"],Wxid:this[a(455)]}}))[a(626)][a(721)]}async[_0xb417a7(554)+_0xb417a7(526)+"ge"](e,t){var a=_0xb417a7,n={JkiTw:function(e){return e()},bwNKS:function(e){return e()}};await SyyRequest[a(952)]({url:"/message/S"+a(552)+a(465)+this[a(578)],data:{CardAlias:t.getAlias(),CardFlag:0,CardNickName:t.getNickname(),CardWxId:t.getUsername(),ToUserName:e}});return(new Response)[a(935)](n.JkiTw(_0x157450))["setMessage"+a(610)]({clientmsgid:n.JkiTw(_0x157450),newclientmsgid:n[a(565)](_0x157450),createtime:(new Date)[a(658)]()})}async[_0xb417a7(611)](){var e=_0xb417a7;return await SyyRequest[e(533)]({url:"/login/Log"+e(530)+this[e(578)],data:{}}),(new Response)[e(935)]({evQiA:function(e){return e()}}[e(727)](_0x157450))[e(511)+e(610)]({clientmsgid:_0x157450(),newclientmsgid:_0x157450(),createtime:(new Date)[e(658)]()})}async[_0xb417a7(949)+_0xb417a7(889)](e,t,a){var n=_0xb417a7;return SyyRequest[n(952)]({url:"/message/R"+n(496)+n(780)+this[n(578)],data:{ClientMsgId:t,CreateTime:0,NewMsgId:a,ToUserName:e}})}async[_0xb417a7(497)+_0xb417a7(921)](e,t){var a=_0xb417a7;return(await SyyRequest[a(952)]({url:a(467)+a(838)+a(657)+this[a(578)],data:{TopIc:t,UserList:e}}))[a(626)].chatRoomName[a(735)]}async[_0xb417a7(956)+"roomMembers"](e,t){var a=_0xb417a7;await SyyRequest[a(952)]({url:a(828)+a(724)+"mMerbers?k"+a(780)+this[a(578)],data:{ChatRoomName:e,UserList:[t]}})}async[_0xb417a7(852)+_0xb417a7(801)](e,t){var a=_0xb417a7,n={ejDSK:a(856),KpKWt:a(743)},e=(console[a(503)](n[a(637)],e,t),await SyyRequest[a(952)]({url:a(550)+"dDelDelCha"+a(527)+a(673)+this[a(578)],data:{ChatRoomName:e,UserList:[t]}}));if(console[a(503)](n[a(716)],e),-2==e?.Data?.[a(581)+"se"]?.[a(613)])throw new Error(a(972)+a(977))}async[_0xb417a7(821)+_0xb417a7(744)](s){const r={Gniin:function(e,t){return e(t)},rTKwh:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{var n=await SyyRequest.post({url:a(810)+"ChatroomQrCode?key="+this[a(578)],data:{ChatRoomName:s}});r[a(807)](e,n)}catch(e){r[a(468)](t,e)}})}async[_0xb417a7(729)+"mName"](e,t){var a=_0xb417a7;await SyyRequest[a(952)]({url:"/group/SetChatroomNa"+a(602)+this[a(578)],data:{ChatRoomName:e,Nickname:t}})}async["getChatRoo"+_0xb417a7(916)+_0xb417a7(848)](e){var t=_0xb417a7;await SyyRequest.post({url:"/group/SetGetChatRoomInfoDetail?key="+this[t(578)],data:{ChatRoomName:e}})}async[_0xb417a7(729)+_0xb417a7(916)+"ent"](e,t){var a=_0xb417a7;await SyyRequest[a(952)]({url:a(931)+"ChatRoomAn"+a(680)+a(890)+this.token,data:{ChatRoomName:e,Content:t}})}async[_0xb417a7(965)](e,t,a,n){var s=_0xb417a7;await SyyRequest[s(952)]({url:s(944)+"rifyUser?k"+s(780)+this[s(578)],data:{V3:a,V4:t,OpCode:3,Scene:n}})}async[_0xb417a7(460)+"st"](){const o={bdUQW:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{var n=await SyyRequest.get({url:a(947)+a(842)+"elList?key="+this[a(578)],data:{}}),s=[];if(n[a(626)][a(933)+"ist"])for(const i of n[a(626)][a(933)+a(532)]){var r=(new Label).setId(i[a(589)])[a(887)](i[a(839)]);s.push(r)}o[a(669)](e,s)}catch(e){}})}async[_0xb417a7(878)](e){var t=_0xb417a7;return await SyyRequest[t(952)]({url:"/label/Add"+t(842)+t(967)+this.token,data:{LabelName:e,wxid:this[t(455)]}})}async[_0xb417a7(945)+"l"](s){const r={AmVib:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=_0x2394;try{var n=await SyyRequest.post({url:a(785)+"ete?key="+this[a(578)],data:{LabelID:String(s),Wxid:this[a(455)]}});r.AmVib(e,n)}catch(e){}})}async[_0xb417a7(559)+_0xb417a7(500)](r,i){const o=_0xb417a7,c={llSRJ:o(735),xpkNw:function(e,t){return e(t)}};return new Promise(async(e,t)=>{var a=o,n=i.filter(e=>!isNaN(e));try{var s=await SyyRequest[a(952)]({url:a(835)+a(477)+a(780)+this[a(578)],data:{LabelId:n[a(812)](",")||"",LabelNameList:[c[a(482)]],UserLabelList:[{LabelIDList:"",UserName:r}]}});c[a(712)](e,s)}catch(e){}})}}export{Api};