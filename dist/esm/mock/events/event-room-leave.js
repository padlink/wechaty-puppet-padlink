!function(){for(var e=_0x5c0b,r=_0x11dc();;)try{if(275340==-parseInt(e(224))+-parseInt(e(236))/2*(-parseInt(e(221))/3)+-parseInt(e(242))/4*(parseInt(e(249))/5)+-parseInt(e(215))/6*(parseInt(e(245))/7)+-parseInt(e(220))/8+parseInt(e(222))/9*(-parseInt(e(217))/10)+parseInt(e(227))/11)break;r.push(r.shift())}catch(e){r.push(r.shift())}}();import{isRoomId}from"../utils/is-type.js";import{parseSysmsgSysmsgTemplateMessagePayload}from"../messages/message-sysmsg.js";import"../utils/regex.js";import{parseSysmsgTemplate}from"../messages/sysmsg/message-sysmsgtemplate.js";import{WechatMessageType}from"../types.js";function _0x11dc(){const e=["WfHJk","56wmXppV","vJNxK","set","userName","1450stMCgB","payload","135894zMROVd","rsFnI","641450ScIqVI","rId","createtime","3189032VOmwVl","147YWcgQM","45hpkevX","currentUse","170498OIcBkf","Sys","delete","12549493UbIyDb","ist","SYqoT","PcMHp","content","get","oKVAC","map","roomMember","10318EUwzYN","Search","type","fromuserna","match","forEach","652ccxTPR","some"];return(_0x11dc=function(){return e})()}import{executeRunners}from"../utils/runner.js";const YOU_REMOVE_OTHER_REGEX_LIST=[/^(你)将"(.+)"移出了群聊/,/^(You) removed "(.+)" from the group chat/],OTHER_REMOVE_YOU_REGEX_LIST=[/^(你)被"([^"]+?)"移出群聊/,/^(You) were removed from the group chat by "([^"]+)"/],roomLeaveDebounceMap=new Map,DEBOUNCE_TIMEOUT=36e5;function roomLeaveDebounceKey(e,r){return e+":"+r}function roomLeaveAddDebounce(e,r){const o=_0x5c0b,t={SYqoT:function(e,r,o){return e(r,o)},JZoHC:function(e,r){return e(r)},PcMHp:function(e,r,o){return e(r,o)}},n=t[o(229)](roomLeaveDebounceKey,e,r),s=roomLeaveDebounceMap[o(232)](n);s&&t.JZoHC(clearTimeout,s);e=t[o(230)](setTimeout,()=>{var e=o;roomLeaveDebounceMap[e(226)](n)},DEBOUNCE_TIMEOUT);roomLeaveDebounceMap[o(247)](n,e)}function removeRoomLeaveDebounce(e,r){var o=_0x5c0b,e=roomLeaveDebounceKey(e,r);roomLeaveDebounceMap[o(226)](e)}function isRoomLeaveDebouncing(e,r){const o=_0x5c0b,t=function(e,r,o){return e(r,o)},n=function(e,r){return e!==r},s=t(roomLeaveDebounceKey,e,r);return n(roomLeaveDebounceMap[o(232)](s),void 0)}function _0x5c0b(e,r){const o=_0x11dc();return(_0x5c0b=function(e,r){return e-=214,o[e]})(e,r)}export default async(s,a)=>{const t=_0x5c0b,u={vJNxK:function(e,r){return e(r)},WfHJk:function(e,r,o,t){return e(r,o,t)},oKVAC:function(e,r){return e!==r},rsFnI:function(e,r){return e!==r},Rxdzw:function(e,r){return e(r)}},c=a[t(239)+"me"];var e;return u[t(246)](isRoomId,c)?((e=await u.Rxdzw(executeRunners,[async()=>{const n=t,e=await u[n(246)](parseSysmsgSysmsgTemplateMessagePayload,a);return e?u[n(244)](parseSysmsgTemplate,e,YOU_REMOVE_OTHER_REGEX_LIST,async e=>{const r=n,o=e[0][r(214)],t=o[r(234)](e=>e[r(248)]).filter(e=>!!e);return{removeeIdList:t,removerId:s[r(223)+r(218)],roomId:c,timestamp:a[r(219)]}}):null},async()=>{const r=t;if(u[r(233)](a.type,WechatMessageType[r(225)]))return null;let o=null;var e;return OTHER_REMOVE_YOU_REGEX_LIST.some(e=>!!(o=a[r(231)][r(240)](e))),o?(e=o[2],e=(await s[r(235)+r(237)](c,e))[0],{removeeIdList:[s.currentUserId],removerId:e,roomId:c,timestamp:a[r(219)]}):null},async()=>{const r=t;if(u[r(216)](a[r(238)],WechatMessageType.Sys))return null;let o=null;var e;return YOU_REMOVE_OTHER_REGEX_LIST[r(243)](e=>!!(o=a.content[r(240)](e))),o?(e=o[2],{removeeIdList:[(await s[r(235)+r(237)](c,e))[0]],removerId:s[r(223)+r(218)],roomId:c,timestamp:a[r(219)]}):null}]))&&e["removeeIdL"+t(228)][t(241)](e=>{roomLeaveAddDebounce(c,e)}),e):null};export{removeRoomLeaveDebounce,isRoomLeaveDebouncing};