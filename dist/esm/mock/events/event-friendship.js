function _0x43de(e,t){const r=_0x1be4();return(_0x43de=function(e,t){return e-=383,r[e]})(e,t)}!function(){for(var e=_0x43de,t=_0x1be4();;)try{if(425441==-parseInt(e(395))+-parseInt(e(410))/2+parseInt(e(385))/3+-parseInt(e(387))/4*(-parseInt(e(406))/5)+-parseInt(e(390))/6+-parseInt(e(396))/7+parseInt(e(394))/8)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();import*as _0xcb722e from"wechaty-puppet";import{isContactId,isIMContactId}from"../utils/is-type.js";function _0x1be4(){const e=["247128cdbyFa","scene","sername","Receive","sharecardn","JLrFS","NNIKI","ickname","encryptuse","vgvEm","ZsbLf","1221102XwXvfr","Friendship","5108UFuabu","msg","createtime","604944TqnXSV","sharecardu","sDQDI","fromuserna","2195320JTyKxz","688376POxJQa","953827yixZXW","content","types","some","nterprise","rname","ticket","sourcenick","match","Verify","3105cSqhnZ","VerifyMsg","Confirm","VerifyMsgE"];return(_0x1be4=function(){return e})()}import{xmlToJson}from"../utils/xml-to-json.js";import{WechatMessageType}from"../types.js";const FRIENDSHIP_CONFIRM_REGEX_LIST=[/^You have added (.+) as your WeChat contact. Start chatting!$/,/^你已添加了(.+)，现在可以开始聊天了。$/,/I've accepted your friend request. Now let's chat!$/,/^(.+) just added you to his\/her contacts list. Send a message to him\/her now!$/,/^(.+)刚刚把你添加到通讯录，现在可以开始聊天了。$/,/^我通过了你的朋友验证请求，现在我们可以开始聊天了$/],FRIENDSHIP_VERIFY_REGEX_LIST=[/^(.+) has enabled Friend Confirmation/,/^(.+)开启了朋友验证，你还不是他（她）朋友。请先发送朋友验证请求，对方验证通过后，才能聊天。/],isConfirm=r=>FRIENDSHIP_CONFIRM_REGEX_LIST.some(e=>{var t=_0x43de;return!!r[t(397)][t(404)](e)}),isNeedVerify=r=>{const n=_0x43de;return FRIENDSHIP_VERIFY_REGEX_LIST[n(399)](e=>{var t=n;return!!r[t(397)][t(404)](e)})},isReceive=async e=>{var t=_0x43de,r={NNIKI:function(e,t){return e!==t},xUmKy:function(e,t){return e(t)},vgvEm:function(e,t){return e(t)},JLrFS:function(e,t){return e(t)}};if(!r[t(416)](e.type,WechatMessageType[t(407)])||!r[t(416)](e.type,WechatMessageType[t(409)+t(400)]))try{var n=await r.xUmKy(xmlToJson,e[t(397)]),s=n[t(388)].$[t(393)+"me"];if(r[t(383)](isContactId,s)&&n[t(388)].$[t(418)+t(401)])return n;if(r[t(415)](isIMContactId,s))return n}catch(e){}return null};export default async(e,t)=>{var r,n=_0x43de,s={sDQDI:function(e,t){return e(t)},ZsbLf:function(e,t,r){return e(t,r)}};return s[n(392)](isConfirm,t)?{contactId:t[n(393)+"me"],id:t.id,timestamp:t[n(389)],type:_0xcb722e[n(398)].Friendship[n(408)]}:s[n(392)](isNeedVerify,t)?{contactId:t[n(393)+"me"],id:t.id,timestamp:t[n(389)],type:_0xcb722e[n(398)][n(386)][n(405)]}:(r=await isReceive(t))?{contactId:r[n(388)].$[n(393)+"me"],hello:r[n(388)].$.content,id:t.id,scene:s[n(384)](parseInt,r[n(388)].$[n(411)],10),shareCardContactId:r[n(388)].$[n(391)+n(412)],shareCardNickName:r.msg.$[n(414)+n(417)],sourceContactId:r[n(388)].$.sourceusername,sourceNickName:r[n(388)].$[n(403)+"name"],stranger:r[n(388)].$[n(418)+n(401)],ticket:r.msg.$[n(402)],timestamp:t[n(389)],type:_0xcb722e[n(398)][n(386)][n(413)]}:null};