function _0x2c7f(){const e=["wEhvK","createtime","IYuLQ","776VzrFSH","userName","map","191CvwMfz","2988NOuxAJ","248OUuCBz","23685vzVKNk","filter","inviteeIdL","forEach","GJsKa","KSkHh","length","roomMember","unshift","61857vKTZSC","pfJuA","split","currentUse","9221744vIxNQB","content","ydamx","Search","ZKjbc","Sys","rId","type","33352660VyTFkl","fromuserna","4816638fZzXcR","kCNKd","ist","EyNPO","xlpsa","payload","roomId","all","288561hmYvkk","aHbza"];return(_0x2c7f=function(){return e})()}function _0x4fa3(e,t){const r=_0x2c7f();return(_0x4fa3=function(e,t){return e-=160,r[e]})(e,t)}!function(){for(var e=_0x4fa3,t=_0x2c7f();;)try{if(698353==-parseInt(e(201))*(-parseInt(e(160))/2)+-parseInt(e(193))/3+parseInt(e(198))/4*(-parseInt(e(162))/5)+-parseInt(e(185))/6+-parseInt(e(175))/7+-parseInt(e(161))/8*(-parseInt(e(171))/9)+parseInt(e(183))/10)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();import{isRoomId}from"../utils/is-type.js";import{removeRoomLeaveDebounce}from"./event-room-leave.js";import{parseSysmsgSysmsgTemplateMessagePayload}from"../messages/message-sysmsg.js";import{WechatMessageType}from"../types.js";import{parseTextWithRegexList}from"../utils/regex.js";import{createSysmsgTemplateRunner}from"../messages/sysmsg/message-sysmsgtemplate.js";import{executeRunners}from"../utils/runner.js";const YOU_INVITE_OTHER_REGEX_LIST=[/^你邀请"(.+)"加入了群聊 {2}\$revoke\$/,/^You invited (.+) to the group chat/],OTHER_INVITE_YOU_REGEX_LIST=[/^"([^"]+?)"邀请你加入了群聊，群聊参与人还有：(.+)/,/^(.+) invited you to a group chat with (.+)/],OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST=[/^"([^"]+?)"邀请你和"(.+?)"加入了群聊/,/^(.+?) invited you and (.+?) to (the|a) group chat/],OTHER_INVITE_OTHER_REGEX_LIST=[/^"(.+)"邀请"(.+)"加入了群聊/,/^(.+?) invited (.+?) to (the|a) group chat/],OTHER_JOIN_VIA_YOUR_QRCODE_REGEX_LIST=[/^" ?(.+)"通过扫描你分享的二维码加入群聊/,/^" ?(.+)" joined group chat via the QR code you shared/],OTHER_JOIN_VIA_OTHER_QRCODE_REGEX_LIST=[/^" (.+)"通过扫描"(.+)"分享的二维码加入群聊/,/^"(.+)" joined the group chat via the QR Code shared by "(.+)"/],OTHER_JOIN_BY_GAME=[/^(.*?)通过(.+)加入群聊/,/^(.*?) joined the group chat through (.+)/];export default async(_,I)=>{const u=_0x4fa3,s={aHbza:function(e,t,r,n){return e(t,r,n)},kCNKd:function(e,t){return e<t},ydamx:function(e,t,r,n){return e(t,r,n)},KSkHh:function(e,t,r,n){return e(t,r,n)},vpggu:function(e,t){return e(t)},pfJuA:function(e,t){return e(t)},xlpsa:function(e,t){return e!==t},YVIpf:function(e,t,r,n){return e(t,r,n)},IYuLQ:function(e,t,r,n){return e(t,r,n)},GJsKa:function(e,t,r,n){return e(t,r,n)},ZKjbc:function(e,t){return e(t)},EyNPO:function(e,t){return e!==t}},E=I[u(184)+"me"];if(!s.vpggu(isRoomId,E))return null;const o=I.createtime,e=await s[u(172)](parseSysmsgSysmsgTemplateMessagePayload,I);if(!e&&s[u(189)](I[u(182)],1e4))return null;let r=null;if(e){var t=s[u(167)](createSysmsgTemplateRunner,e,[...YOU_INVITE_OTHER_REGEX_LIST,...OTHER_JOIN_VIA_YOUR_QRCODE_REGEX_LIST],async e=>{const t=u,r=e[0][t(190)],n=r.map(e=>e[t(199)])[t(163)](e=>!!e);return{inviteeIdList:n,inviterId:_[t(174)+t(181)],roomId:E,timestamp:o}}),n=s.YVIpf(createSysmsgTemplateRunner,e,OTHER_INVITE_YOU_REGEX_LIST,async e=>{var t=u,e=e[0].payload;return{inviteeIdList:[_[t(174)+t(181)]],inviterId:e[0][t(199)],roomId:E,timestamp:o}}),a=s[u(167)](createSysmsgTemplateRunner,e,[...OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST,...OTHER_INVITE_OTHER_REGEX_LIST],async(e,t)=>{const r=u,n=e[0][r(190)],a=e[1][r(190)],s=a[r(200)](e=>e[r(199)])[r(163)](e=>!!e),i=t<OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST[r(168)];return i&&s.unshift(_[r(174)+r(181)]),{inviteeIdList:s,inviterId:n[0][r(199)],roomId:E,timestamp:o}}),i=s[u(197)](createSysmsgTemplateRunner,e,OTHER_JOIN_VIA_OTHER_QRCODE_REGEX_LIST,async e=>{const t=u,r=e[0][t(190)],n=r[t(200)](e=>e[t(199)])[t(163)](e=>!!e),a=e[1][t(190)];return{inviteeIdList:n,inviterId:a[0][t(199)],roomId:E,timestamp:o}}),m=s[u(166)](createSysmsgTemplateRunner,e,OTHER_JOIN_BY_GAME,async e=>{var t=u;return{inviteeIdList:e[0].payload.map(e=>e.userName)[t(163)](e=>!!e),inviterId:_[t(174)+t(181)],roomId:E,timestamp:o}});(r=await s[u(179)](executeRunners,[t,n,a,i,m]))&&r[u(164)+u(187)][u(165)](e=>{var t=u;removeRoomLeaveDebounce(r[t(191)],e)})}else{if(s[u(188)](I[u(182)],WechatMessageType[u(180)]))return null;r=await s.ZKjbc(executeRunners,[async()=>{const n=u;return s[n(194)](parseTextWithRegexList,I[n(176)],[...YOU_INVITE_OTHER_REGEX_LIST,...OTHER_JOIN_VIA_YOUR_QRCODE_REGEX_LIST],async(e,t)=>{var r=n,t=(t[1],t[2]);return{inviteeIdList:[(await _[r(169)+r(178)](E,t))[0]],inviterId:_[r(174)+"rId"],roomId:E,timestamp:I.createtime}})},async()=>{const n=u;return s.aHbza(parseTextWithRegexList,I[n(176)],OTHER_INVITE_YOU_REGEX_LIST,async(e,t)=>{var r=n,t=t[1],t=(await _["roomMember"+r(178)](E,t))[0];return{inviteeIdList:[_.currentUserId],inviterId:t,roomId:E,timestamp:I[r(196)]}})},async()=>{const i=u,o={wEhvK:function(e,t){var r=_0x4fa3;return s[r(186)](e,t)}};return s[i(177)](parseTextWithRegexList,I.content,[...OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST,...OTHER_INVITE_OTHER_REGEX_LIST],async(e,t)=>{const r=i,n=t[1],a=await Promise[r(192)](t[2][r(173)]("、")[r(200)](async e=>{var t=r;return(await _[t(169)+"Search"](E,e))[0]})),s=o[r(195)](e,OTHER_INVITE_YOU_AND_OTHER_REGEX_LIST[r(168)]);s&&a[r(170)](_[r(174)+r(181)]);t=(await _[r(169)+r(178)](E,n))[0];return{inviteeIdList:a,inviterId:t,roomId:E,timestamp:I[r(196)]}})},async()=>{const a=u;return s[a(167)](parseTextWithRegexList,I.content,OTHER_JOIN_VIA_OTHER_QRCODE_REGEX_LIST,async(e,t)=>{var r=a,n=t[1],t=t[2],n=(await _["roomMember"+r(178)](E,n))[0];return{inviteeIdList:[(await _[r(169)+"Search"](E,t))[0]],inviterId:n,roomId:E,timestamp:I[r(196)]}})}])}return r};