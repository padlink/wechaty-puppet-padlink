const _0x5a8dfb=_0x1412;function _0x2c5c(){const a=["_labelList","ions.dispo","setRoomInv","962495wuzJuH","keys","oad","friendship","5688415DoFJLK","mkdirp","all","puppet-pad","se(%s, %s)","BkQCf","hasRoom","setLabelLi","es ...","_roomMembe","homedir","[CacheMana"," Contacts,","close() ca","vokeCache","6295818hVQUcU","6570440ttEBRC","plus-cache","_messageRe","MkEbM","actStrange","initCache(","5691944xNQCco","setRoomMem","set","18gBTTyk","_userName","stringify",") inited ","setFriends","ationCache","ranger-ali","rCache","r-raw-payl","che closed","StrangerAl","gjlra","hipRawPayl",".wechaty","ber","close","_messageCa","_friendshi","itation","pCache","join","Count","getRoomCou","setContact","622383HnhqgN","delete","rAlias","_contactSe","setRoom","ation-raw-","hasContact","already in","pIpzZ","close()","silly","getRoomIds","w-payload","get","AQERN","getContact","Search","osing cach","UbWbp","room-invit","OVqJC","values","_contactSt","_roomCache","UhheE","size","getAllCont","_contactCa","9958420nqGJzR","push","ias","ayload","4XXrWFW","qYbFS","room-membe","getRoomMem","DEDeN","sCache","has","deleteCont","RevokeInfo","getMessage","archCache","rangerAlia","deleteRoom","che not ex","itialized","acts","constructo","sep","r() lruOpt","_roomInvit","getFriends","7AFUXuz","che"];return(_0x2c5c=function(){return a})()}!function(){for(var a=_0x1412,t=_0x2c5c();;)try{if(711800==+parseInt(a(237))+-parseInt(a(322))/2*(parseInt(a(290))/3)+parseInt(a(263))/4+-parseInt(a(241))/5+parseInt(a(256))/6+parseInt(a(343))/7*(parseInt(a(257))/8)+parseInt(a(266))/9*(-parseInt(a(318))/10))break;t.push(t.shift())}catch(a){t.push(t.shift())}}();import _0x59fd49 from"fs-extra";import _0x17d2ea from"os";import _0x55dd9f from"path";import{LRUCache}from"lru-cache";function _0x1412(a,t){const e=_0x2c5c();return(_0x1412=function(a,t){return a-=233,e[a]})(a,t)}import{log}from"wechaty-puppet";import{FlashStore}from"flash-store";const PRE=_0x5a8dfb(252)+"ger]";class CacheManager{[_0x5a8dfb(267)];[_0x5a8dfb(282)+_0x5a8dfb(233)];[_0x5a8dfb(259)+_0x5a8dfb(255)];[_0x5a8dfb(317)+_0x5a8dfb(233)];[_0x5a8dfb(293)+_0x5a8dfb(332)];[_0x5a8dfb(312)+_0x5a8dfb(333)+"sCache"];[_0x5a8dfb(313)];[_0x5a8dfb(250)+_0x5a8dfb(273)];[_0x5a8dfb(341)+_0x5a8dfb(271)];[_0x5a8dfb(283)+_0x5a8dfb(285)];[_0x5a8dfb(234)];constructor(a){this[_0x5a8dfb(267)]=a}async["init"](){const s=_0x5a8dfb,r={OVqJC:s(338)+s(340)+"ions.dispo"+s(245),DEDeN:s(279),BkQCf:function(a,t){return a*t},MIgLW:"contact-ra"+s(302),BDZvl:function(a,t){return a*t},MkEbM:"contact-st"+s(272)+"as",gjlra:"room-raw-p"+s(321),qYbFS:s(324)+s(274)+s(239),pIpzZ:s(309)+s(295)+"payload",AQERN:s(240)+"-raw-payload"};if(this[s(282)+s(233)])throw new Error(s(297)+s(336));var a=_0x55dd9f[s(286)](_0x17d2ea[s(251)](),_0x55dd9f.sep,r[s(326)],s(244)+s(258),_0x55dd9f[s(339)],this._userName,_0x55dd9f.sep),t=(await _0x59fd49.pathExists(a)||await _0x59fd49[s(242)](a),this[s(282)+s(233)]=new LRUCache({dispose(a,t){var e=s;log[e(300)](PRE,r[e(310)],a,JSON[e(268)](t))},max:1e3,ttl:r[s(246)](6e4,60)}),this[s(259)+s(255)]=new LRUCache({dispose(a,t){var e=s;log[e(300)](PRE,r[e(310)],a,JSON[e(268)](t))},max:1e3,ttl:r[s(246)](r.BkQCf(1e3,60),60)}),this[s(317)+s(233)]=new FlashStore(_0x55dd9f[s(286)](a,r.MIgLW)),this[s(293)+"archCache"]=new LRUCache({dispose(a,t){var e=s;log[e(300)](PRE,e(338)+e(340)+e(235)+e(245),a,JSON.stringify(t))},max:1e3,ttl:r.BDZvl(6e4,60)}),this["_contactStrangerAlia"+s(327)]=new FlashStore(_0x55dd9f[s(286)](a,r[s(260)])),this[s(313)]=new FlashStore(_0x55dd9f[s(286)](a,r[s(277)])),this["_roomMembe"+s(273)]=new FlashStore(_0x55dd9f[s(286)](a,r[s(323)])),this["_roomInvit"+s(271)]=new FlashStore(_0x55dd9f[s(286)](a,r[s(298)])),this[s(283)+s(285)]=new FlashStore(_0x55dd9f[s(286)](a,r[s(304)])),await this["_contactCa"+s(233)][s(315)]);log[s(300)](PRE,s(262)+s(269)+t+(s(253)+'  cachedir="')+a+'"')}async["close"](){var a=_0x5a8dfb,t={UhheE:a(299),nhOBC:"close() cl"+a(307)+a(249),UbWbp:a(254)+a(275)+"."};log[a(300)](PRE,t[a(314)]),this[a(317)+a(233)]&&this["_contactSt"+a(333)+a(327)]&&this[a(250)+"rCache"]&&this[a(313)]&&this[a(283)+a(285)]&&this[a(341)+"ationCache"]&&this[a(282)+a(233)]?(log[a(300)](PRE,t.nhOBC),await Promise[a(243)]([this["_contactCa"+a(233)].close(),this[a(312)+a(333)+"sCache"][a(281)](),this[a(250)+"rCache"].close(),this[a(313)][a(281)](),this[a(283)+a(285)].close(),this[a(341)+a(271)].close()]),this["_contactCa"+a(233)]=void 0,this["_contactSt"+a(333)+"sCache"]=void 0,this[a(250)+"rCache"]=void 0,this[a(313)]=void 0,this[a(283)+a(285)]=void 0,this[a(341)+a(271)]=void 0,this[a(282)+a(233)]=void 0,log[a(300)](PRE,t[a(308)])):log[a(300)](PRE,a(254)+a(335)+"ist.")}async[_0x5a8dfb(331)](a){var t=_0x5a8dfb;return this[t(282)+"che"][t(303)](a)}async["setMessage"](a,t){var e=_0x5a8dfb;await this[e(282)+e(233)][e(265)](a,t)}async["hasMessage"](a){var t=_0x5a8dfb;return this[t(282)+"che"][t(328)](a)}async["getMessageRevokeInfo"](a){var t=_0x5a8dfb;return this[t(259)+t(255)].get(a)}async["setMessage"+_0x5a8dfb(330)](a,t){var e=_0x5a8dfb;await this[e(259)+e(255)][e(265)](a,t)}async[_0x5a8dfb(305)](a){var t=_0x5a8dfb;return this[t(317)+"che"][t(303)](a)}async[_0x5a8dfb(289)](a,t){var e=_0x5a8dfb;await this[e(317)+e(233)][e(265)](a,t)}async[_0x5a8dfb(329)+"act"](a){var t=_0x5a8dfb;await this["_contactCa"+t(233)][t(291)](a)}async[_0x5a8dfb(305)+"Ids"](){var a=_0x5a8dfb,t=[];for await(const e of this[a(317)+a(233)][a(238)]())t[a(319)](e);return t}async[_0x5a8dfb(316)+_0x5a8dfb(337)](){var a=_0x5a8dfb,t=[];for await(const e of this[a(317)+a(233)][a(311)]())t[a(319)](e);return t}async[_0x5a8dfb(296)](a){return this["_contactCa"+_0x5a8dfb(233)].has(a)}async[_0x5a8dfb(305)+_0x5a8dfb(287)](){var a=_0x5a8dfb;return this[a(317)+a(233)][a(315)]}async[_0x5a8dfb(305)+_0x5a8dfb(306)](a){var t=_0x5a8dfb;return this[t(293)+"archCache"][t(303)](a)}async[_0x5a8dfb(289)+_0x5a8dfb(306)](a,t){var e=_0x5a8dfb;await this["_contactSe"+e(332)][e(265)](a,t)}async[_0x5a8dfb(296)+_0x5a8dfb(306)](a){var t=_0x5a8dfb;return this[t(293)+"archCache"][t(328)](a)}async[_0x5a8dfb(305)+_0x5a8dfb(276)+_0x5a8dfb(320)](a){return this._contactStrangerAliasCache.get(a)}async[_0x5a8dfb(289)+_0x5a8dfb(276)+"ias"](a,t){var e=_0x5a8dfb;await this[e(312)+"rangerAlia"+e(327)][e(265)](a,t)}async[_0x5a8dfb(329)+_0x5a8dfb(261)+_0x5a8dfb(292)](a){var t=_0x5a8dfb;await this[t(312)+t(333)+t(327)][t(291)](a)}async["getRoom"](a){return this[_0x5a8dfb(313)].get(a)}async[_0x5a8dfb(294)](a,t){var e=_0x5a8dfb;await this[e(313)][e(265)](a,t)}async[_0x5a8dfb(334)](a){var t=_0x5a8dfb;await this._roomCache[t(291)](a)}async[_0x5a8dfb(301)](){var a=_0x5a8dfb,t=[];for await(const e of this[a(313)][a(238)]())t[a(319)](e);return t}async[_0x5a8dfb(288)+"nt"](){var a=_0x5a8dfb;return this[a(313)][a(315)]}async[_0x5a8dfb(247)](a){return this[_0x5a8dfb(313)].has(a)}async[_0x5a8dfb(325)+_0x5a8dfb(280)](a){var t=_0x5a8dfb;return this[t(250)+t(273)][t(303)](a)}async[_0x5a8dfb(264)+_0x5a8dfb(280)](a,t){var e=_0x5a8dfb;await this["_roomMembe"+e(273)][e(265)](a,t)}async["deleteRoomMember"](a){var t=_0x5a8dfb;await this[t(250)+t(273)][t(291)](a)}async["getRoomInv"+_0x5a8dfb(284)](a){var t=_0x5a8dfb;return this[t(341)+"ationCache"][t(303)](a)}async[_0x5a8dfb(236)+_0x5a8dfb(284)](a,t){await this["_roomInvit"+_0x5a8dfb(271)].set(a,t)}async["deleteRoomInvitation"](a){var t=_0x5a8dfb;await this[t(341)+t(271)][t(291)](a)}async[_0x5a8dfb(342)+"hipRawPayl"+_0x5a8dfb(239)](a){return this["_friendshi"+_0x5a8dfb(285)].get(a)}async[_0x5a8dfb(270)+_0x5a8dfb(278)+"oad"](a,t){var e=_0x5a8dfb;await this[e(283)+"pCache"][e(265)](a,t)}["getLabelList"](){return this[_0x5a8dfb(234)]}[_0x5a8dfb(248)+"st"](a){this[_0x5a8dfb(234)]=a}}export{CacheManager};